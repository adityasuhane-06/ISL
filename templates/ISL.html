<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <title>Sign Sarthi - Indian Sign Language Detection Platform</title>

  <!-- Bootstrap core CSS -->
  <link href="{{ url_for('static', filename='vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">


  <!-- Additional CSS Files -->
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/fontawesome.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/templatemo-tale-seo-agency.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/owl.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/animate.css') }}">
  <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/isl.css') }}">

</head>

<body style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin: 0; padding: 0;">

  <!-- Modern Rounded Navigation -->
  <nav class="modern-nav">
    <div class="nav-container">
      <div class="nav-content">
        <!-- Logo -->
        <a href="/" class="nav-logo">
          <img src="{{ url_for('static', filename='assets/images/logo.png') }}" alt="Sign Sarthi">
          <span class="logo-text">Sign Sarthi</span>
        </a>
        
        <!-- Navigation Links -->
        <div class="nav-links">
          <a href="/" class="nav-link">
            <i class="fas fa-home"></i>
            <span>Home</span>
          </a>
          <a href="/isl" class="nav-link active">
            <i class="fas fa-video"></i>
            <span>ISL</span>
          </a>
          <a href="#projects" class="nav-link">
            <i class="fas fa-hand-paper"></i>
            <span>NFSL</span>
          </a>
          <a href="/text_to_isl" class="nav-link">
            <i class="fas fa-text-height"></i>
            <span>Text</span>
          </a>
          <a href="/about" class="nav-link">
            <i class="fas fa-info-circle"></i>
            <span>About</span>
          </a>
          <a href="/community" class="nav-link">
            <i class="fas fa-users"></i>
            <span>Community</span>
          </a>
        </div>

        <!-- Mobile Menu Toggle -->
        <button class="mobile-toggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Menu Overlay -->
  <div class="mobile-menu">
    <div class="mobile-menu-content">
      <button class="mobile-close">
        <i class="fas fa-times"></i>
      </button>
      <a href="/" class="mobile-link">
        <i class="fas fa-home"></i>
        <span>Home</span>
      </a>
      <a href="/isl" class="mobile-link active">
        <i class="fas fa-video"></i>
        <span>ISL</span>
      </a>
      <a href="#projects" class="mobile-link">
        <i class="fas fa-hand-paper"></i>
        <span>NFSL</span>
      </a>
      <a href="/text_to_isl" class="mobile-link">
        <i class="fas fa-text-height"></i>
        <span>Text</span>
      </a>
      <a href="/about" class="mobile-link">
        <i class="fas fa-info-circle"></i>
        <span>About</span>
      </a>
      <a href="/community" class="mobile-link">
        <i class="fas fa-users"></i>
        <span>Community</span>
      </a>
    </div>
  </div>
  
  <main style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px 20px 60px 20px; min-height: 100vh; overflow-x: hidden;">

    <div class="main" id="main" style="max-width: 1400px; margin: 0 auto; padding: 0 15px; overflow: hidden; margin-bottom: 0; padding-bottom: 0;">
      
      <!-- Main Content Layout: Video on left, Text displays on right -->
      <div class="row" style="margin-bottom: 30px; margin-left: 0; margin-right: 0;">
        
        <!-- Video Section (Left Column) - Increased width -->
        <div class="col-lg-7 col-md-12 mb-4">
          <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); height: 100%;">
            <h2 style="text-align: center; color: #333; margin-bottom: 25px; font-size: 28px; font-weight: 600;">
              üìπ Live Sign Detection
            </h2>
            <div class="video" style="position: relative; max-width: 100%; margin: 0 auto; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.2); background: #000;">
              <!-- Browser camera video element -->
              <video id="videoElement" autoplay playsinline muted style="display: block; width: 100%; height: auto; background: #000; position: relative; z-index: 1;"></video>
              <!-- Canvas to show hand landmarks overlaid -->
              <canvas id="processedCanvas" style="position: absolute; top: 0; left: 0; pointer-events: none; z-index: 2;"></canvas>
              <!-- Status indicator -->
              <div id="statusIndicator" style="position: absolute; top: 10px; right: 10px; background: rgba(76,175,80,0.95); color: white; padding: 8px 15px; border-radius: 20px; font-size: 13px; font-weight: 600; z-index: 10; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">
                üü¢ Camera Active
              </div>
              <div id="predictionIndicator" style="position: absolute; bottom: 15px; left: 15px; background: rgba(33,150,243,0.95); color: white; padding: 15px 20px; border-radius: 15px; font-size: 28px; font-weight: bold; min-width: 60px; text-align: center; z-index: 10; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">
                -
              </div>
            </div>
            
            <!-- Status Legend Cards -->
            <div style="margin-top: 20px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
              <div style="background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); padding: 10px 12px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üìπ</span>
                <div style="flex: 1;">
                  <div style="color: white; font-size: 11px; font-weight: 700; line-height: 1.2;">Camera Ready</div>
                  <div style="color: rgba(255,255,255,0.9); font-size: 9px;">System Active</div>
                </div>
              </div>
              
              <div style="background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); padding: 10px 12px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üîµ</span>
                <div style="flex: 1;">
                  <div style="color: white; font-size: 11px; font-weight: 700; line-height: 1.2;">New Sign</div>
                  <div style="color: rgba(255,255,255,0.9); font-size: 9px;">Detected</div>
                </div>
              </div>
              
              <div style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); padding: 10px 12px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üü†</span>
                <div style="flex: 1;">
                  <div style="color: white; font-size: 11px; font-weight: 700; line-height: 1.2;">Building</div>
                  <div style="color: rgba(255,255,255,0.9); font-size: 9px;">Hold 1 sec</div>
                </div>
              </div>
              
              <div style="background: linear-gradient(135deg, #8bc34a 0%, #689f38 100%); padding: 10px 12px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üü¢</span>
                <div style="flex: 1;">
                  <div style="color: white; font-size: 11px; font-weight: 700; line-height: 1.2;">Added</div>
                  <div style="color: rgba(255,255,255,0.9); font-size: 9px;">Character Set</div>
                </div>
              </div>
              
              <div style="background: linear-gradient(135deg, #9e9e9e 0%, #757575 100%); padding: 10px 12px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üëã</span>
                <div style="flex: 1;">
                  <div style="color: white; font-size: 11px; font-weight: 700; line-height: 1.2;">No Hand</div>
                  <div style="color: rgba(255,255,255,0.9); font-size: 9px;">Not Detected</div>
                </div>
              </div>
              
              <div style="background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%); padding: 10px 12px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">‚ùå</span>
                <div style="flex: 1;">
                  <div style="color: white; font-size: 11px; font-weight: 700; line-height: 1.2;">Error</div>
                  <div style="color: rgba(255,255,255,0.9); font-size: 9px;">System Issue</div>
                </div>
              </div>
            </div>
            
            <!-- Tips Section -->
            <div style="margin-top: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 15px 18px; border-radius: 12px; box-shadow: 0 3px 10px rgba(0,0,0,0.2);">
              <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                <span style="font-size: 20px;">üí°</span>
                <span style="color: white; font-size: 14px; font-weight: 700;">Quick Tips</span>
              </div>
              <ul style="margin: 0; padding-left: 20px; color: white; font-size: 11px; line-height: 1.6;">
                <li>Hold each sign steady for 1 second</li>
                <li>Keep hand centered in frame with good lighting</li>
                <li>Wait for green indicator before next sign</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Text Display Section (Right Column) - Reduced to fit -->
        <div class="col-lg-5 col-md-12 mb-4">
          <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
            
            <!-- Predicted Text Card -->
            <div style="background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
              <label style="display: block; color: #667eea; font-size: 20px; font-weight: 700; margin-bottom: 15px;">
                üí¨ Predicted Text
              </label>
              <div style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border: 3px solid #667eea; border-radius: 12px; padding: 25px; min-height: 90px; font-size: 24px; color: #333; word-wrap: break-word; font-weight: 500; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                <span id="predictedText"></span>
              </div>
            </div>

            <!-- Translated Text Card -->
            <div style="background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
              <label style="display: block; color: #764ba2; font-size: 20px; font-weight: 700; margin-bottom: 15px;">
                üåê Translated Text
              </label>
              <div style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border: 3px solid #764ba2; border-radius: 12px; padding: 25px; min-height: 90px; font-size: 24px; color: #333; word-wrap: break-word; font-weight: 500; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                <span id="translatedText"></span>
              </div>
            </div>

            <!-- Control Buttons Panel (Inside Right Column) -->
            <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
              <h3 style="text-align: center; color: #333; margin-bottom: 25px; font-size: 22px; font-weight: 700;">
                üéÆ Control Panel
              </h3>
              
              <!-- Buttons in Grid Layout -->
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                
                <button class="button" id="bt1" onclick="clearLastCharacter()" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; padding: 16px 22px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 5px 20px rgba(240,147,251,0.5); white-space: nowrap;">
                  üîô Clear Last
                </button>

                <button class="button" id="bt2" onclick="speakSentence()" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; border: none; padding: 16px 22px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 5px 20px rgba(79,172,254,0.5); white-space: nowrap;">
                  üîä Speak
                </button>

                <button class="button" id="bt3" onclick="clearSentence()" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; border: none; padding: 16px 22px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 5px 20px rgba(250,112,154,0.5); white-space: nowrap;">
                  üóëÔ∏è Clear All
                </button>

                <button class="button" id="bt4" onclick="addspace()" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); color: white; border: none; padding: 16px 22px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 5px 20px rgba(48,207,208,0.5); white-space: nowrap;">
                  ‚éµ Space
                </button>
                
                <!-- Translate button spans 2 columns -->
                <button id="translateBtn" class="button" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 16px 18px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 5px 20px rgba(102,126,234,0.5); display: flex; align-items: center; justify-content: space-between; gap: 12px; white-space: nowrap; grid-column: span 2;">
                  <span style="display: flex; align-items: center; gap: 8px; flex-shrink: 0;">
                    <span style="font-size: 18px;">üåç</span>
                    <span style="font-size: 15px;">Translate:</span>
                  </span>
                  <select id="languageSelect" style="border: 2px solid white; background-color: rgba(255,255,255,0.3); color: white; font-size: 14px; padding: 7px 12px; border-radius: 6px; font-weight: 600; cursor: pointer; outline: none; min-width: 110px; flex-shrink: 0;">
                    <option value="en" style="color: #333;">English</option>
                    <option value="hi" style="color: #333;">Hindi</option>
                    <option value="bn" style="color: #333;">Bengali</option>
                    <option value="te" style="color: #333;">Telugu</option>
                    <option value="ta" style="color: #333;">Tamil</option>
                    <option value="ml" style="color: #333;">Malayalam</option>
                    <option value="gu" style="color: #333;">Gujarati</option>
                    <option value="kn" style="color: #333;">Kannada</option>
                    <option value="pa" style="color: #333;">Punjabi</option>
                  </select>
                </button>

              </div>
            </div>

          </div>
        </div>

      </div>

    </div>
            
            <!-- Add hover effects with inline style -->
            <style>
              /* Modern Navigation Styles */
              .modern-nav {
                background: rgba(255, 255, 255, 0.15);
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 20px;
                margin: 25px auto;
                max-width: 1400px;
                padding: 0;
              }

              .nav-container {
                padding: 0 30px;
              }

              .nav-content {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 18px 0;
              }

              .nav-logo {
                display: flex;
                align-items: center;
                gap: 15px;
                text-decoration: none;
                transition: transform 0.3s;
              }

              .nav-logo:hover {
                transform: scale(1.05);
              }

              .nav-logo img {
                height: 50px;
                width: 50px;
                object-fit: contain;
                border-radius: 10px;
                background: rgba(255, 255, 255, 0.9);
                padding: 5px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
              }

              .logo-text {
                font-size: 24px;
                font-weight: 700;
                color: white;
                letter-spacing: 0.5px;
              }

              .nav-links {
                display: flex;
                gap: 8px;
                align-items: center;
              }

              .nav-link {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 12px 20px;
                color: white;
                text-decoration: none;
                border-radius: 12px;
                font-size: 15px;
                font-weight: 600;
                transition: all 0.3s;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(5px);
              }

              .nav-link:hover {
                background: rgba(255, 255, 255, 0.3);
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.15);
                color: white;
                text-decoration: none;
              }

              .nav-link.active {
                background: rgba(255, 255, 255, 0.35);
                box-shadow: 0 5px 20px rgba(255,255,255,0.2);
              }

              .nav-link i {
                font-size: 18px;
              }

              .mobile-toggle {
                display: none;
                background: rgba(255, 255, 255, 0.2);
                border: none;
                color: white;
                padding: 12px 16px;
                border-radius: 10px;
                font-size: 20px;
                cursor: pointer;
                transition: all 0.3s;
              }

              .mobile-toggle:hover {
                background: rgba(255, 255, 255, 0.3);
              }

              /* Mobile Menu */
              .mobile-menu {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                z-index: 9999;
                opacity: 0;
                transition: opacity 0.3s;
              }

              .mobile-menu.active {
                display: flex;
                opacity: 1;
              }

              .mobile-menu-content {
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(15px);
                width: 280px;
                height: 100%;
                padding: 30px;
                transform: translateX(-100%);
                transition: transform 0.3s;
                overflow-y: auto;
              }

              .mobile-menu.active .mobile-menu-content {
                transform: translateX(0);
              }

              .mobile-close {
                background: rgba(102, 126, 234, 0.2);
                border: none;
                color: #667eea;
                padding: 12px;
                border-radius: 10px;
                font-size: 24px;
                cursor: pointer;
                margin-bottom: 30px;
                width: 100%;
                transition: all 0.3s;
              }

              .mobile-close:hover {
                background: rgba(102, 126, 234, 0.3);
              }

              .mobile-link {
                display: flex;
                align-items: center;
                gap: 15px;
                padding: 15px 20px;
                color: #667eea;
                text-decoration: none;
                border-radius: 12px;
                font-size: 16px;
                font-weight: 600;
                margin-bottom: 10px;
                background: rgba(102, 126, 234, 0.1);
                transition: all 0.3s;
              }

              .mobile-link:hover,
              .mobile-link.active {
                background: rgba(102, 126, 234, 0.25);
                transform: translateX(5px);
                color: #667eea;
                text-decoration: none;
              }

              .mobile-link i {
                font-size: 20px;
                width: 25px;
              }

              /* Responsive Design */
              @media (max-width: 1200px) {
                .nav-link span {
                  display: none;
                }
                .nav-link {
                  padding: 12px 15px;
                }
                .nav-link i {
                  margin: 0;
                }
              }

              @media (max-width: 992px) {
                .modern-nav {
                  margin: 20px;
                  border-radius: 15px;
                }
                
                .nav-links {
                  display: none;
                }

                .mobile-toggle {
                  display: block;
                }

                .logo-text {
                  font-size: 20px;
                }

                .nav-logo img {
                  height: 40px;
                }
              }

              @media (max-width: 576px) {
                .modern-nav {
                  margin: 15px;
                  border-radius: 12px;
                }

                .nav-container {
                  padding: 0 20px;
                }

                .nav-content {
                  padding: 12px 0;
                }

                .logo-text {
                  display: none;
                }
              }

              /* Button hover effects */
              .button:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.3) !important;
              }
              .button:active {
                transform: translateY(-1px);
              }
              
              /* CRITICAL: Hide all Bootstrap clearfix and pseudo-elements */
              .row::after,
              .row::before,
              .col-12::after,
              .col-12::before,
              .col-lg-7::after,
              .col-lg-7::before,
              .col-lg-5::after,
              .col-lg-5::before,
              .col-md-12::after,
              .col-md-12::before,
              .buttons::after,
              .buttons::before,
              .main::after,
              .main::before {
                display: none !important;
                content: none !important;
                visibility: hidden !important;
                height: 0 !important;
                width: 0 !important;
              }
              
              /* Remove all bottom margins and padding after main content */
              .row:last-child {
                margin-bottom: 0 !important;
              }
              
              main {
                padding-bottom: 60px !important;
              }
              
              /* Ensure clean container */
              .main {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
              }
              
              /* Hide any Bootstrap clearfix class */
              .clearfix,
              .clearfix::before,
              .clearfix::after {
                display: none !important;
              }
              
              /* CRITICAL FIX: Hide duplicate button containers */
              .buttons ~ * {
                display: none !important;
              }
              
              /* Ensure NO elements show below the control panel */
              .col-12 > .buttons ~ * {
                display: none !important;
                visibility: hidden !important;
                height: 0 !important;
                opacity: 0 !important;
              }
            </style>
            
          </div>
        </div>
      </div>

    </div>
  </main>


  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->

  <script src="{{ url_for('static', filename='vendor/jquery/jquery.min.js') }}"></script>
  <script src="{{ url_for('static', filename='vendor/bootstrap/js/bootstrap.min.js') }}"></script>
  <script src="{{ url_for('static', filename='assets/js/isotope.min.js') }}"></script>
  <script src="{{ url_for('static', filename='assets/js/owl-carousel.js') }}"></script>
  <script src="{{ url_for('static', filename='assets/js/tabs.js') }}"></script>
  <script src="{{ url_for('static', filename='assets/js/popup.js') }}"></script>
  <script src="{{ url_for('static', filename='assets/js/custom.js') }}"></script>

  <!-- Mobile Menu Script -->
  <script>
    // Mobile menu toggle
    const mobileToggle = document.querySelector('.mobile-toggle');
    const mobileMenu = document.querySelector('.mobile-menu');
    const mobileClose = document.querySelector('.mobile-close');

    if (mobileToggle) {
      mobileToggle.addEventListener('click', () => {
        mobileMenu.classList.add('active');
        document.body.style.overflow = 'hidden';
      });
    }

    if (mobileClose) {
      mobileClose.addEventListener('click', () => {
        mobileMenu.classList.remove('active');
        document.body.style.overflow = '';
      });
    }

    // Close mobile menu when clicking outside
    if (mobileMenu) {
      mobileMenu.addEventListener('click', (e) => {
        if (e.target === mobileMenu) {
          mobileMenu.classList.remove('active');
          document.body.style.overflow = '';
        }
      });
    }

    // Close mobile menu on link click
    const mobileLinks = document.querySelectorAll('.mobile-link');
    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.remove('active');
        document.body.style.overflow = '';
      });
    });
  </script>


  <script>
    // Camera and frame processing
    const videoElement = document.getElementById('videoElement');
    const processedCanvas = document.getElementById('processedCanvas');
    const predictionIndicator = document.getElementById('predictionIndicator');
    const statusIndicator = document.getElementById('statusIndicator');
    const ctx = processedCanvas.getContext('2d');
    
    // Disable image smoothing for sharper rendering
    ctx.imageSmoothingEnabled = false;
    
    let stream = null;
    let processingFrame = false;
    let previousSign = null;
    let startTime = null;
    const detectionThreshold = 1000; // 1 second in milliseconds
    let frameCount = 0;

    // Start camera
    async function startCamera() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ 
          video: { 
            width: { ideal: 640 },
            height: { ideal: 480 },
            facingMode: 'user'
          } 
        });
        videoElement.srcObject = stream;
        
        // Set canvas size to match video
        videoElement.onloadedmetadata = () => {
          // Match canvas size exactly to video display size
          const rect = videoElement.getBoundingClientRect();
          processedCanvas.width = videoElement.videoWidth;
          processedCanvas.height = videoElement.videoHeight;
          processedCanvas.style.width = rect.width + 'px';
          processedCanvas.style.height = rect.height + 'px';
          
          statusIndicator.textContent = 'üìπ Camera Ready';
          statusIndicator.style.background = 'rgba(0,255,0,0.8)';
          console.log('Camera started successfully');
        };
        
        // Start processing frames after a short delay
        setTimeout(() => {
          console.log('Starting frame processing...');
          processFrames();
        }, 1000);
      } catch (err) {
        console.error("Error accessing camera:", err);
        statusIndicator.textContent = '‚ùå Camera Error';
        statusIndicator.style.background = 'rgba(255,0,0,0.8)';
        alert("Unable to access camera. Please grant camera permissions.");
      }
    }

    // Capture and send frame to server
    async function processFrames() {
      // Always schedule next frame first - this keeps video smooth
      requestAnimationFrame(() => {
        setTimeout(processFrames, 150); // Process at ~6-7 FPS to reduce server load
      });
      
      // Skip if already processing or camera not ready
      if (!stream || processingFrame || !videoElement.videoWidth) {
        return;
      }

      processingFrame = true;
      frameCount++;

      try {
        // Create canvas to capture frame
        const canvas = document.createElement('canvas');
        canvas.width = videoElement.videoWidth;
        canvas.height = videoElement.videoHeight;
        const context = canvas.getContext('2d');
        
        // Draw current video frame to canvas
        context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);
        
        // Convert to base64 with lower quality for speed
        const frameData = canvas.toDataURL('image/jpeg', 0.5);
        
        // Update status every 10 frames
        if (frameCount % 10 === 0) {
          statusIndicator.textContent = `üìπ Active (${frameCount})`;
        }
        
        // Send to server for processing (with shorter timeout)
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 2000); // 2 second timeout
        
        fetch('/process_frame', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ frame: frameData }),
          signal: controller.signal
        })
        .then(response => {
          clearTimeout(timeoutId);
          return response.json();
        })
        .then(result => {
          if (result.error) {
            predictionIndicator.textContent = '‚ùå';
            predictionIndicator.style.background = 'rgba(255,0,0,0.5)';
          } else if (result.success && result.prediction) {
            const currentSign = result.prediction;
            const now = Date.now();
            
            // Update prediction indicator
            predictionIndicator.textContent = currentSign;
            
            // If same sign detected for threshold time, add to text
            if (currentSign === previousSign) {
              if (startTime === null) {
                startTime = now;
                predictionIndicator.style.background = 'rgba(255,165,0,0.8)'; // Orange - detecting
              } else if (now - startTime >= detectionThreshold) {
                // Add to predicted text
                addToPredictedText(currentSign);
                predictionIndicator.style.background = 'rgba(0,255,0,0.9)'; // Green - added
                // Keep showing for 500ms then reset
                setTimeout(() => {
                  predictionIndicator.style.background = 'rgba(0,150,255,0.8)';
                }, 500);
                startTime = null;
              }
            } else {
              previousSign = currentSign;
              startTime = null;
              predictionIndicator.style.background = 'rgba(0,150,255,0.8)'; // Blue - new sign
            }
            
            // Draw hand landmarks (circles) on transparent canvas over video
            if (result.processed_image) {
              const img = new Image();
              img.onload = () => {
                try {
                  // Clear previous landmarks
                  ctx.clearRect(0, 0, processedCanvas.width, processedCanvas.height);
                  // Draw the landmarks image on canvas
                  ctx.drawImage(img, 0, 0, processedCanvas.width, processedCanvas.height);
                  console.log('Landmarks drawn on canvas');
                } catch (e) {
                  console.warn("Canvas drawing error:", e);
                }
              };
              img.onerror = () => {
                console.error('Failed to load processed image');
              };
              img.src = result.processed_image;
            } else {
              console.log('No processed_image in result');
            }
          } else {
            // No hand detected - clear landmarks from canvas
            predictionIndicator.textContent = 'üëã';
            predictionIndicator.style.background = 'rgba(128,128,128,0.3)';
            previousSign = null;
            startTime = null;
            // Clear canvas when no hand detected
            ctx.clearRect(0, 0, processedCanvas.width, processedCanvas.height);
          }
        })
        .catch(error => {
          // Don't show errors for timeouts - just silently continue
          if (error.name !== 'AbortError') {
            console.warn("Frame skipped:", error.message);
          }
          clearTimeout(timeoutId);
        })
        .finally(() => {
          processingFrame = false;
        });
        
      } catch (error) {
        console.warn("Frame capture error:", error.message);
        processingFrame = false;
      }
    }

    // Add character to predicted text
    function addToPredictedText(char) {
      console.log('addToPredictedText called with:', char);
      const currentText = predictedTextElement.textContent;
      // Update via server to keep state synchronized
      fetch('/add_character', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ character: char })
      }).then(() => {
        updatePredictedText();
      }).catch(err => {
        console.error('Error adding character:', err);
      });
    }

    // Start camera when page loads
    console.log('Page loaded, starting camera...');
    startCamera();

    // Select all buttons with the class 'button'
    const buttons = document.querySelectorAll(".button");

    // Add an event listener to each button
    buttons.forEach((button) => {
      button.addEventListener("click", (e) => {
        e.preventDefault();
        button.classList.add("animate");

        // Remove the animation class after 600ms
        setTimeout(() => {
          button.classList.remove("animate");
        }, 600);
      });
    });

  
    document.addEventListener("DOMContentLoaded", () => {
  const predictedTextElement = document.getElementById('predictedText');
  const translatedTextElement = document.getElementById('translatedText');
  const translateBtn = document.getElementById('translateBtn');
  const languageSelect = document.getElementById('languageSelect');
  const translatedTextContainer = document.getElementById('translatedTextContainer');
  // Translation functionality integrated with the button
  translateBtn.addEventListener("click", () => {
    const textToTranslate = predictedTextElement.textContent.trim();
    const targetLang = languageSelect.value;

    if (!textToTranslate) return;

    // API call for translation
    const apiUrl = `https://api.mymemory.translated.net/get?q=${textToTranslate}&langpair=en|${targetLang}`;

    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        const translatedText = data.responseData.translatedText;
        translatedTextElement.textContent = translatedText;
        
      })
      .catch(error => {
        console.error("Error fetching translation:", error);
      });
  });
});


  </script>






  <script>
    const predictedTextElement = document.getElementById('predictedText');


    function updatePredictedText() {
      fetch('/get_predicted_text')
        .then(response => response.json())
        .then(data => {
          predictedTextElement.textContent = data.predicted_text;
        });
    }

    // Function to clear the entire sentence
    function clearSentence() {
      fetch('/clear_sentence', { method: 'POST' })
        .then(response => response.json())
        .then(() => {
          updatePredictedText();
        });
    }

    // Function to clear the last character of the predicted text
    function clearLastCharacter() {
      fetch('/clear_last_character', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
          predictedTextElement.textContent = data.predicted_text;
        });
    }

    // Function to send a request to speak the sentence
    function speakSentence() {
      fetch('/speak_sentence', { method: 'POST' });
    }

    // Function to add a space in the predicted text
    function addspace() {
      fetch('/add_space', { method: 'POST' });
    }

    // Periodically update the predicted text every second
    setInterval(updatePredictedText, 1000);
  </script>





</body>

</html>